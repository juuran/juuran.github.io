import{Stacki}from"../etc/stacki.js";import*as Util from"../etc/util.js";class Tila{#i;_undoLista;_redoLista;#t;constructor(i,t){this.#i=i,this._undoLista=new Stacki(this.#i),this._redoLista=new Stacki(this.#i),this.#t=t}muutaTilaa(i,t=!0){this.#a(this.#t,i),this.#s(i),t&&(this._undoLista.pushaa(this.#t),this.hasRedo()&&(this._redoLista=new Stacki(this.#i))),this.#t=i}naytaTila(){return this.#t}undo(){this.hasUndo()&&(this._redoLista.pushaa(this.#t),this.#t=this._undoLista.poppaa())}redo(){this.hasRedo()&&(this._undoLista.pushaa(this.#t),this.#t=this._redoLista.poppaa())}hasUndo(){return this._undoLista.hasArvo()}hasRedo(){return this._redoLista.hasArvo()}#a(i,t){if(null==t)throw new Error("Tilaa ei voida asettaa tyhjäksi arvoksi.");if(!t.henkilot||!t.suhteet)throw new Error("Tilasta puuttui jokin vaadituista kentistä!");if(i===t)throw new Error("Uusi tila on tismalleen sama kuin aiempi! Onko ohjelmassa bugi?");if(i.henkilot===t.henkilot&&i.suhteet===t.suhteet)throw new Error("Uudessa tilassa on tismalleen samoja kenttiä kuin aiemmassa! Onko ohjelmassa bugi?")}#s(i){try{i.henkilot.forEach((i=>{i.initialXPosition=i.getXPosition(),i.initialYPosition=i.getYPosition()})),i.suhteet.forEach((i=>{i.initialXPosition=i.getXPosition(),i.initialYPosition=i.getYPosition()}))}catch(i){Util.logDebug("Koodrinaattien jäädyttäminen ei onnistu, luultavasti kyseessä tuoreeltaan serveriltä haettu data, jolla ei vielä solmu-vastinparia.")}Util.logDebug("Koordinaatit jäädytetty onnistuneesti.")}}export{Tila};